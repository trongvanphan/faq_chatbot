ğŸ­ CONTEXT MANAGEMENT & MULTI-TURN CONVERSATION DEMO
This demo shows the difference between context-aware and context-unaware chatbots

================================================================================
ğŸ“š HOW CONTEXT MANAGEMENT WORKS - STEP BY STEP
================================================================================

1. Message Storage: Má»—i tin nháº¯n (user vÃ  bot) Ä‘Æ°á»£c lÆ°u vá»›i timestamp
```
conversation_history = [
    {"role": "user", "content": "Gá»£i Ã½ xe SUV", "timestamp": "2025-06-28T10:00:00"},
    {"role": "assistant", "content": "Honda CR-V, Toyota RAV4...", "timestamp": "2025-06-28T10:00:05"}
]```


2. Context Building: Khi cÃ³ cÃ¢u há»i má»›i, toÃ n bá»™ lá»‹ch sá»­ Ä‘Æ°á»£c gá»­i cho AI
```
messages = [
    {"role": "system", "content": "Báº¡n lÃ  trá»£ lÃ½ Ã´ tÃ´, nhá»› cuá»™c trÃ² chuyá»‡n..."},
    {"role": "user", "content": "Gá»£i Ã½ xe SUV"},
    {"role": "assistant", "content": "Honda CR-V, Toyota RAV4..."},
    {"role": "user", "content": "Honda CR-V cÃ³ Æ°u Ä‘iá»ƒm gÃ¬?"}  # CÃ¢u há»i má»›i
]```


3. Reference Resolution: AI hiá»ƒu 'Honda CR-V' Ä‘Æ°á»£c Ä‘á» cáº­p trong cÃ¢u tráº£ lá»i trÆ°á»›c
```
# AI nháº­n Ä‘Æ°á»£c toÃ n bá»™ context nÃªn biáº¿t:
# - Honda CR-V Ä‘Æ°á»£c Ä‘á» cáº­p trong response trÆ°á»›c
# - User Ä‘ang há»i vá» xe Ä‘Ã³ cá»¥ thá»ƒ
# - KhÃ´ng cáº§n tÃ¬m kiáº¿m láº¡i danh sÃ¡ch SUV```


4. Context Summary: TÃ³m táº¯t chá»§ Ä‘á» Ä‘á»ƒ quáº£n lÃ½ token limit
```
context_summary = "ÄÃ£ tÆ° váº¥n xe SUV | Quan tÃ¢m Honda CR-V"
# GiÃºp AI nhá»› nhá»¯ng gÃ¬ quan trá»ng ngay cáº£ khi conversation dÃ i```

================================================================================
ğŸš« DEMO: WITHOUT Context Management (Current Implementation)
================================================================================

ğŸ‘¤ Cuá»™c trÃ² chuyá»‡n báº¯t Ä‘áº§u...

ğŸ‘¤ User: Gá»£i Ã½ xe SUV cho tÃ´i
ğŸ”„ Calling OpenAI API...
ğŸ”§ Executing function: get_car_recommendations with args: {'car_type': 'suv'}
ğŸ”„ Getting final response...
ğŸ¤– Bot: DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ gá»£i Ã½ xe SUV phá»• biáº¿n táº¡i Viá»‡t Nam mÃ  báº¡n cÃ³ thá»ƒ tham kháº£o:

1. **Honda CR-V**
2. **Toyota RAV4**
3. **Mazda CX-5**
4. **Ford EcoSport**
5. **Hyundai Tucson**

Náº¿u báº¡n cáº§n thÃªm thÃ´ng tin vá» má»™t máº«u xe cá»¥ thá»ƒ nÃ o Ä‘Ã³, hÃ£y cho tÃ´i biáº¿t!
ğŸ“ Context: Má»—i cÃ¢u há»i Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»™c láº­p - bot khÃ´ng nhá»› gÃ¬!
------------------------------------------------------------
ğŸ‘¤ User: Honda CR-V cÃ³ Æ°u Ä‘iá»ƒm gÃ¬?
ğŸ”„ Calling OpenAI API...
ğŸ¤– Bot: Xin lá»—i, nhÆ°ng tÃ´i chá»‰ cÃ³ thá»ƒ cung cáº¥p thÃ´ng tin liÃªn quan Ä‘áº¿n Ã´ tÃ´. Báº¡n cÃ³ thá»ƒ há»i vá» cÃ¡c loáº¡i xe, lá»‹ch báº£o dÆ°á»¡ng, máº¹o tiáº¿t kiá»‡m nhiÃªn liá»‡u hoáº·c thÃ´ng tin khÃ¡c liÃªn quan Ä‘áº¿n Ã´ tÃ´. HÃ£y cho tÃ´i biáº¿t náº¿u báº¡n cáº§n thÃ´ng tin nÃ o khÃ¡c!
ğŸ“ Context: Má»—i cÃ¢u há»i Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»™c láº­p - bot khÃ´ng nhá»› gÃ¬!
------------------------------------------------------------
ğŸ‘¤ User: GiÃ¡ cá»§a nÃ³ nhÆ° tháº¿ nÃ o?
ğŸ”„ Calling OpenAI API...
ğŸ¤– Bot: Xin lá»—i, nhÆ°ng tÃ´i chá»‰ cÃ³ thá»ƒ cung cáº¥p thÃ´ng tin liÃªn quan Ä‘áº¿n Ã´ tÃ´. Báº¡n cÃ³ thá»ƒ há»i vá» cÃ¡c loáº¡i xe, báº£o dÆ°á»¡ng, máº¹o tiáº¿t kiá»‡m nhiÃªn liá»‡u hoáº·c thÃ´ng tin khÃ¡c liÃªn quan Ä‘áº¿n Ã´ tÃ´. HÃ£y cho tÃ´i biáº¿t báº¡n cáº§n gÃ¬!
ğŸ“ Context: Má»—i cÃ¢u há»i Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»™c láº­p - bot khÃ´ng nhá»› gÃ¬!
------------------------------------------------------------
ğŸ‘¤ User: So vá»›i Toyota RAV4 thÃ¬ sao?
ğŸ”„ Calling OpenAI API...
ğŸ¤– Bot: Xin lá»—i, nhÆ°ng tÃ´i khÃ´ng thá»ƒ tráº£ lá»i cÃ¢u há»i nÃ y náº¿u khÃ´ng cÃ³ thÃªm thÃ´ng tin vá» Ä‘iá»u báº¡n muá»‘n so sÃ¡nh vá»›i Toyota RAV4. Báº¡n cÃ³ thá»ƒ há»i vá» cÃ¡c loáº¡i xe khÃ¡c, thÃ´ng tin báº£o trÃ¬, hoáº·c máº¹o tiáº¿t kiá»‡m nhiÃªn liá»‡u liÃªn quan Ä‘áº¿n Ã´ tÃ´. HÃ£y cho tÃ´i biáº¿t báº¡n cáº§n gÃ¬!
ğŸ“ Context: Má»—i cÃ¢u há»i Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»™c láº­p - bot khÃ´ng nhá»› gÃ¬!
------------------------------------------------------------

================================================================================
âœ… DEMO: WITH Context Management (New Implementation)
================================================================================
ğŸ”„ Conversation context has been reset.

ğŸ‘¤ Cuá»™c trÃ² chuyá»‡n báº¯t Ä‘áº§u...

ğŸ‘¤ User: Gá»£i Ã½ xe SUV cho tÃ´i
ğŸ”„ Processing question with 1 messages of context...
ğŸ”§ Executing function: get_car_recommendations with args: {'car_type': 'suv'}
ğŸ”„ Getting contextualized final response...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 4, 'context_summary': 'ÄÃ£ tÆ° váº¥n xe suv', 'last_topics': ['SUV']}
ğŸ¤– Bot: DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ gá»£i Ã½ xe SUV phá»• biáº¿n táº¡i Viá»‡t Nam mÃ  báº¡n cÃ³ thá»ƒ tham kháº£o:

1. **Honda CR-V**
2. **Toyota RAV4**
3. **Mazda CX-5**
4. **Ford EcoSport**
5. **Hyundai Tucson**

Náº¿u báº¡n cáº§n thÃªm thÃ´ng tin chi tiáº¿t vá» má»™t máº«u xe nÃ o Ä‘Ã³, hÃ£y cho tÃ´i biáº¿t!
ğŸ“ Context: 4 tin nháº¯n, Topics: ['SUV']
ğŸ’­ Summary: ÄÃ£ tÆ° váº¥n xe suv
------------------------------------------------------------
ğŸ‘¤ User: Honda CR-V cÃ³ Æ°u Ä‘iá»ƒm gÃ¬?
ğŸ”„ Processing question with 5 messages of context...
ğŸ”§ Executing function: search_faq with args: {'query': 'Honda CR-V Æ°u Ä‘iá»ƒm'}
ğŸ”„ Getting contextualized final response...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 8, 'context_summary': 'ÄÃ£ tÆ° váº¥n xe suv', 'last_topics': []}
ğŸ¤– Bot: Honda CR-V cÃ³ má»™t sá»‘ Æ°u Ä‘iá»ƒm ná»•i báº­t nhÆ° sau:

1. **KhÃ´ng gian rá»™ng rÃ£i**: CR-V cung cáº¥p khÃ´ng gian ná»™i tháº¥t thoáº£i mÃ¡i cho cáº£ hÃ nh khÃ¡ch vÃ  hÃ ng hÃ³a, ráº¥t phÃ¹ há»£p cho gia Ä‘Ã¬nh.

2. **Tiáº¿t kiá»‡m nhiÃªn liá»‡u**: Máº«u xe nÃ y thÆ°á»ng cÃ³ má»©c tiÃªu thá»¥ nhiÃªn liá»‡u tháº¥p hÆ¡n so vá»›i nhiá»u Ä‘á»‘i thá»§ trong phÃ¢n khÃºc SUV.

3. **CÃ´ng nghá»‡ an toÃ n**: Honda CR-V Ä‘Æ°á»£c trang bá»‹ nhiá»u tÃ­nh nÄƒng an toÃ n hiá»‡n Ä‘áº¡i, bao gá»“m cáº£ há»‡ thá»‘ng há»— trá»£ lÃ¡i vÃ  cáº£nh bÃ¡o va cháº¡m.

4. **Hiá»‡u suáº¥t váº­n hÃ nh**: Äá»™ng cÆ¡ máº¡nh máº½ vÃ  há»‡ thá»‘ng treo tá»‘t giÃºp CR-V cÃ³ kháº£ nÄƒng váº­n hÃ nh á»•n Ä‘á»‹nh trÃªn nhiá»u loáº¡i Ä‘á»‹a hÃ¬nh.

5. **GiÃ¡ trá»‹ bá»n vá»¯ng**: Honda thÆ°á»ng cÃ³ giÃ¡ trá»‹ bÃ¡n láº¡i cao, do Ä‘Ã³ CR-V lÃ  má»™t lá»±a chá»n Ä‘áº§u tÆ° tá»‘t.

Náº¿u báº¡n cáº§n
ğŸ“ Context: 8 tin nháº¯n, Topics: []
ğŸ’­ Summary: ÄÃ£ tÆ° váº¥n xe suv
------------------------------------------------------------
ğŸ‘¤ User: GiÃ¡ cá»§a nÃ³ nhÆ° tháº¿ nÃ o?
ğŸ”„ Processing question with 9 messages of context...
ğŸ”§ Executing function: search_faq with args: {'query': 'Honda CR-V giÃ¡'}
ğŸ”„ Getting contextualized final response...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 12, 'context_summary': 'ÄÃ£ tÆ° váº¥n xe suv', 'last_topics': []}
ğŸ¤– Bot: GiÃ¡ cá»§a Honda CR-V cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y thuá»™c vÃ o phiÃªn báº£n vÃ  trang bá»‹. Táº¡i thá»‹ trÆ°á»ng Viá»‡t Nam, giÃ¡ bÃ¡n cá»§a Honda CR-V thÆ°á»ng dao Ä‘á»™ng tá»« khoáº£ng 1 tá»· Ä‘áº¿n 1.2 tá»· Ä‘á»“ng, tÃ¹y vÃ o cÃ¡c tÃ¹y chá»n vÃ  chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i. 

Äá»ƒ cÃ³ thÃ´ng tin chÃ­nh xÃ¡c nháº¥t, báº¡n nÃªn tham kháº£o tá»« cÃ¡c Ä‘áº¡i lÃ½ Honda hoáº·c trang web chÃ­nh thá»©c cá»§a hÃ£ng. Náº¿u báº¡n cáº§n tÃ¬m hiá»ƒu thÃªm vá» cÃ¡c phiÃªn báº£n cá»¥ thá»ƒ hoáº·c thÃ´ng tin khÃ¡c, hÃ£y cho tÃ´i biáº¿t!
ğŸ“ Context: 12 tin nháº¯n, Topics: []
ğŸ’­ Summary: ÄÃ£ tÆ° váº¥n xe suv
------------------------------------------------------------
ğŸ‘¤ User: So vá»›i Toyota RAV4 thÃ¬ sao?
ğŸ”„ Processing question with 13 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 14, 'context_summary': 'ÄÃ£ tÆ° váº¥n xe suv', 'last_topics': []}
ğŸ¤– Bot: So vá»›i Toyota RAV4, Honda CR-V vÃ  Toyota RAV4 Ä‘á»u lÃ  nhá»¯ng máº«u SUV ráº¥t phá»• biáº¿n vÃ  cÃ³ nhiá»u Æ°u Ä‘iá»ƒm riÃªng. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ Ä‘iá»ƒm so sÃ¡nh giá»¯a hai máº«u xe nÃ y:

1. **Thiáº¿t káº¿**:
   - **Honda CR-V**: CÃ³ thiáº¿t káº¿ hiá»‡n Ä‘áº¡i, tinh táº¿ vá»›i nhiá»u Ä‘Æ°á»ng nÃ©t má»m máº¡i.
   - **Toyota RAV4**: Thiáº¿t káº¿ máº¡nh máº½, nam tÃ­nh hÆ¡n vá»›i cÃ¡c Ä‘Æ°á»ng nÃ©t gÃ³c cáº¡nh.

2. **KhÃ´ng gian ná»™i tháº¥t**:
   - **CR-V**: ThÆ°á»ng Ä‘Æ°á»£c khen ngá»£i vá» khÃ´ng gian rá»™ng rÃ£i vÃ  thoáº£i mÃ¡i cho cáº£ hÃ nh khÃ¡ch vÃ  hÃ ng hÃ³a.
   - **RAV4**: CÅ©ng cÃ³ khÃ´ng gian rá»™ng rÃ£i, nhÆ°ng cÃ³ thá»ƒ khÃ´ng thoáº£i mÃ¡i báº±ng CR-V á»Ÿ hÃ ng gháº¿ sau.

3. **Tiáº¿t kiá»‡m nhiÃªn liá»‡u**:
   - **CR-V**: Ná»•i
ğŸ“ Context: 14 tin nháº¯n, Topics: []
ğŸ’­ Summary: ÄÃ£ tÆ° váº¥n xe suv
------------------------------------------------------------

================================================================================
ğŸ¯ DEMO: Context Management Features
================================================================================
ğŸ”„ Conversation context has been reset.

1. Remembering Previous Recommendations
----------------------------------------
ğŸ”„ Conversation context has been reset.
ğŸ‘¤ Gá»£i Ã½ xe sedan cho tÃ´i
ğŸ”„ Processing question with 1 messages of context...
ğŸ”§ Executing function: get_car_recommendations with args: {'car_type': 'sedan'}
ğŸ”„ Getting contextualized final response...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 4, 'context_summary': 'ÄÃ£ tÆ° váº¥n xe sedan', 'last_topics': ['Sedan']}
ğŸ¤– DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ gá»£i Ã½ xe sedan phá»• biáº¿n mÃ  báº¡n cÃ³ thá»ƒ tham kháº£o:

1. **Honda Civic**
2. **Toyota Camry**
3. **Hyundai Elantra**
4. **Mazda3**
5. **...

ğŸ‘¤ Trong nhá»¯ng xe nÃ y, xe nÃ o tiáº¿t kiá»‡m nhiÃªn liá»‡u nháº¥t?
ğŸ”„ Processing question with 5 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 6, 'context_summary': 'ÄÃ£ tÆ° váº¥n xe sedan', 'last_topics': ['Sedan', 'Tiáº¿t kiá»‡m nhiÃªn liá»‡u']}
ğŸ¤– Trong danh sÃ¡ch gá»£i Ã½ xe sedan, **Honda Civic** thÆ°á»ng Ä‘Æ°á»£c biáº¿t Ä‘áº¿n lÃ  má»™t trong nhá»¯ng máº«u xe tiáº¿t kiá»‡m nhiÃªn liá»‡u nháº¥t. Máº«u xe nÃ y cÃ³ hiá»‡u suáº¥t nhiÃª...


2. Understanding References
----------------------------------------
ğŸ”„ Conversation context has been reset.
ğŸ‘¤ TÃ´i quan tÃ¢m Ä‘áº¿n Honda Civic
ğŸ”„ Processing question with 1 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 2, 'context_summary': '', 'last_topics': []}
ğŸ¤– Honda Civic lÃ  má»™t máº«u xe sedan ráº¥t phá»• biáº¿n vÃ  Ä‘Æ°á»£c Æ°a chuá»™ng. Báº¡n muá»‘n biáº¿t thÃªm thÃ´ng tin gÃ¬ vá» Honda Civic? CÃ³ pháº£i báº¡n Ä‘ang tÃ¬m kiáº¿m gá»£i Ã½ vá» phi...

ğŸ‘¤ NÃ³ cÃ³ Ä‘áº¯t khÃ´ng?
ğŸ”„ Processing question with 3 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 4, 'context_summary': '', 'last_topics': []}
ğŸ¤– GiÃ¡ cá»§a Honda Civic cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y thuá»™c vÃ o phiÃªn báº£n, trang bá»‹ vÃ  khu vá»±c báº¡n Ä‘ang sá»‘ng. ThÃ´ng thÆ°á»ng, giÃ¡ cá»§a Honda Civic má»›i sáº½ dao Ä‘á»™ng tá»« k...

ğŸ‘¤ Khi nÃ o tÃ´i nÃªn báº£o dÆ°á»¡ng nÃ³?
ğŸ”„ Processing question with 5 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 6, 'context_summary': '', 'last_topics': ['Báº£o dÆ°á»¡ng']}
ğŸ¤– Lá»‹ch báº£o dÆ°á»¡ng cho Honda Civic thÆ°á»ng bao gá»“m cÃ¡c dá»‹ch vá»¥ nhÆ° thay dáº§u, kiá»ƒm tra phanh, vÃ  xoay lá»‘p. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ thá»i Ä‘iá»ƒm quan trá»ng báº¡n nÃªn c...


3. Maintaining Topic Flow
----------------------------------------
ğŸ”„ Conversation context has been reset.
ğŸ‘¤ Cho tÃ´i máº¹o tiáº¿t kiá»‡m nhiÃªn liá»‡u
ğŸ”„ Processing question with 1 messages of context...
ğŸ”§ Executing function: get_fuel_efficiency_tips with args: {}
ğŸ”„ Getting contextualized final response...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 4, 'context_summary': '', 'last_topics': ['Tiáº¿t kiá»‡m nhiÃªn liá»‡u']}
ğŸ¤– DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ máº¹o giÃºp báº¡n tiáº¿t kiá»‡m nhiÃªn liá»‡u:

1. Duy trÃ¬ tá»‘c Ä‘á»™ á»•n Ä‘á»‹nh, trÃ¡nh tÄƒng tá»‘c Ä‘á»™t ngá»™t.
2. Kiá»ƒm tra Ã¡p suáº¥t lá»‘p Ä‘á»‹nh ká»³.
3. Loáº¡i bá»...

ğŸ‘¤ Máº¹o nÃ o quan trá»ng nháº¥t?
ğŸ”„ Processing question with 5 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 6, 'context_summary': '', 'last_topics': ['Tiáº¿t kiá»‡m nhiÃªn liá»‡u']}
ğŸ¤– Máº·c dÃ¹ táº¥t cáº£ cÃ¡c máº¹o Ä‘á»u quan trá»ng, nhÆ°ng viá»‡c **duy trÃ¬ tá»‘c Ä‘á»™ á»•n Ä‘á»‹nh vÃ  trÃ¡nh tÄƒng tá»‘c Ä‘á»™t ngá»™t** cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  má»™t trong nhá»¯ng yáº¿u tá»‘ quan ...

ğŸ‘¤ CÃ²n vá» Ã¡p suáº¥t lá»‘p thÃ¬ sao?
ğŸ”„ Processing question with 7 messages of context...
ğŸ’­ Conversation context: {'session_id': 'session_20250628_112927', 'message_count': 8, 'context_summary': '', 'last_topics': []}
ğŸ¤– Kiá»ƒm tra **Ã¡p suáº¥t lá»‘p Ä‘á»‹nh ká»³** cÅ©ng ráº¥t quan trá»ng Ä‘á»ƒ tiáº¿t kiá»‡m nhiÃªn liá»‡u. Ãp suáº¥t lá»‘p thÃ­ch há»£p giÃºp xe váº­n hÃ nh hiá»‡u quáº£ hÆ¡n vÃ  giáº£m ma sÃ¡t vá»›i m...


================================================================================
âœ¨ SUMMARY
================================================================================

ğŸš« WITHOUT Context Management:
- Má»—i cÃ¢u há»i Ä‘á»™c láº­p
- KhÃ´ng hiá»ƒu references ("nÃ³", "xe Ä‘Ã³")
- KhÃ´ng nhá»› Ä‘Ã£ nÃ³i gÃ¬ trÆ°á»›c Ä‘Ã³
- Tráº£i nghiá»‡m nhÆ° chat vá»›i ngÆ°á»i láº¡ má»—i láº§n

âœ… WITH Context Management:
- Nhá»› toÃ n bá»™ cuá»™c trÃ² chuyá»‡n
- Hiá»ƒu references vÃ  pronouns
- Duy trÃ¬ flow tá»± nhiÃªn
- Tráº£i nghiá»‡m nhÆ° nÃ³i chuyá»‡n vá»›i má»™t ngÆ°á»i
    
================================================================================